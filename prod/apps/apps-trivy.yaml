application: trivy-operator
clusterConfig:
  namespace: trivy-system
chart:
  name: trivy-operator
  releaseName: trivy-operator
  repoURL: https://aquasecurity.github.io/helm-charts/
  targetRevision: v0.29.0
  values: |
    trivy:
      ignoreUnfixed: true

    operator:
      vulnerabilityScanner: Trivy
      podSecurityContext:
        runAsNonRoot: true
        runAsUser: 65532
        fsGroup: 65532
        readOnlyRootFilesystem: true
        allowPrivilegeEscalation: false

    serviceAccount:
      create: true
      name: trivy-operator

    rbac:
      create: true
      clusterRole: true

    podDisruptionBudget:
      enabled: true
      minAvailable: 1

    resources:
      requests:
        cpu: 200m
        memory: 256Mi
      limits:
        cpu: 1
        memory: 1Gi

    serviceMonitor:
      enabled: true
      namespace: trivy-system
      interval: 30s
      scrapeTimeout: 15s
      additionalLabels:
        release: kube-prometheus-stack
      selector:
        matchLabels:
          app.kubernetes.io/name: trivy-operator
